{%- comment -%}
  Snippet: Product Showcase Grid

  Purpose: Renders product carousel with horizontal scrolling functionality

  Parameters:
    - products: Collection of products to display
    - carousel_id: Unique identifier for the carousel instance
{%- endcomment -%}

{%- liquid
  # Set default values if not provided
  assign products = products | sort_by: 'best_selling'
  assign total_products = parts-page-specific.product.size

  # Generate a fallback ID if none provided
  assign carousel_id = carousel_id | default: 'grid-' | append: section.id | default: 'default'

  # Calculate if carousel should be shown
  assign should_show_carousel = true

  # Calculate total slides needed based on viewport-responsive grid
  assign total_slides = total_products | divided_by: 4 | ceil
-%}

<product-showcase-carousel>
<div
  class="product-showcase__grid"
  id="carousel-{{ carousel_id }}"
  data-total-products="{{ total_products }}"
  data-total-slides="{{ total_slides }}"
  data-current-slide="1"
  data-carousel-id="{{ carousel_id }}"
  role="region"
  aria-roledescription="carousel"
  aria-label="{{ 'parts-sections.showcase.carousel' | t }}"
>
  <div
    class="product-showcase__track"
    data-carousel-container
    aria-atomic="false"
    aria-live="polite"
  >
    <div class="product-showcase__track-hide-overflow">
      <div class="product-showcase__track-inner">
        {%- for product in products -%}
          <div
            class="product-showcase__slide"
            data-slide-index="{{ forloop.index0 }}"
            role="group"
            aria-roledescription="slide"
            aria-label="{{ 'parts-sections.showcase.slide' | t: number: forloop.index }}"
            {{ block.shopify_attributes }}
          >
            {%- render 'snippet-feature-product-card', product: product -%}
          </div>
        {%- else -%}
          <div class="product-showcase__empty">
            <p>{{ 'parts-sections.showcase.no_products' | t }}</p>
          </div>
        {%- endfor -%}
      </div>
    </div>
  </div>

  {%- if should_show_carousel -%}
    <div class="product-showcase__navigation">
      {%- render 'snippet-feature-arrow-navigation',
        data_attributes: 'data-direction="prev"',
        direction: 'prev',
        style_wrapper: 'glassmorphism',
        position: 'absolute'
      -%}
      {%- render 'snippet-feature-arrow-navigation',
        data_attributes: 'data-direction="next"',
        direction: 'next',
        style_wrapper: 'glassmorphism',
        position: 'absolute'
      -%}
    </div>
  {%- endif -%}
</div>
</product-showcase-carousel>
